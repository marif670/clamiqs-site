<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blog Editor | Admin Panel</title>
    <link href="assets/css/tailwind.css" rel="stylesheet" />
    <link href="assets/css/style.css" rel="stylesheet" />
    <style>
      body {
        background: #f8fafc;
      }
      .editor-section {
        max-width: 900px;
        margin: 2rem auto;
      }
      textarea,
      input {
        width: 100%;
        border: 1px solid #ddd;
        padding: 8px;
        border-radius: 6px;
      }
      #preview {
        background: #fff;
        border-radius: 10px;
        padding: 1.5rem;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      }
      .post-card {
        background: white;
        padding: 1rem;
        border-radius: 8px;
        margin: 1rem 0;
        cursor: pointer;
        transition: 0.2s;
      }
      .post-card:hover {
        background: #f0f9ff;
      }
    </style>
  </head>
  <body class="min-h-screen">
    <!-- üîê LOGIN SCREEN -->
    <div id="login-screen" class="flex items-center justify-center min-h-screen">
      <div class="bg-white p-8 rounded-lg shadow-md w-80">
        <h2 class="text-xl font-bold mb-4 text-center">Admin Login</h2>
        <input
          type="password"
          id="admin-password"
          placeholder="Enter Password"
          class="w-full border p-2 rounded mb-3"
        />
        <button id="login-btn" class="bg-blue-600 text-white px-4 py-2 rounded w-full">
          Login
        </button>
        <p id="login-error" class="text-red-600 text-sm mt-2 hidden">Incorrect password!</p>
      </div>
    </div>

    <!-- ‚úçÔ∏è EDITOR DASHBOARD -->
    <div id="editor-screen" class="hidden p-6">
      <h1 class="text-2xl font-bold mb-4 text-center">üìù Blog Editor Dashboard</h1>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 editor-section">
        <!-- üß© Editor Form -->
        <div>
          <h2 class="font-semibold mb-2">Create / Edit Blog</h2>
          <input type="hidden" id="edit-index" value="" />
          <input id="title" type="text" placeholder="Post Title" class="mb-2" />
          <input id="date" type="date" class="mb-2" />
          <textarea
            id="content"
            rows="10"
            placeholder="Write blog content here..."
            class="mb-2"
          ></textarea>
          <button id="save-btn" class="bg-green-600 text-white px-4 py-2 rounded mr-2">
            üíæ Save Post
          </button>
          <button id="clear-btn" class="bg-gray-500 text-white px-4 py-2 rounded">üßπ Clear</button>
        </div>

        <!-- üëÅÔ∏è Live Preview -->
        <div>
          <h2 class="font-semibold mb-2">Live Preview</h2>
          <div id="preview">
            <h3 class="text-xl font-bold" id="preview-title">Post title...</h3>
            <p class="text-sm text-gray-500" id="preview-date">Post date...</p>
            <div id="preview-content" class="mt-3 text-gray-800">
              Start writing to see preview...
            </div>
          </div>
        </div>
      </div>

      <!-- üìã Existing Posts -->
      <div class="editor-section">
        <h2 class="font-semibold text-lg mb-2">Existing Posts</h2>
        <div id="posts-list"></div>
      </div>
    </div>

    <script>
      const PASSWORD = "admin123"; // change as needed
      const loginBtn = document.getElementById("login-btn");
      const loginScreen = document.getElementById("login-screen");
      const editorScreen = document.getElementById("editor-screen");
      const loginError = document.getElementById("login-error");

      loginBtn.addEventListener("click", () => {
        const inputPass = document.getElementById("admin-password").value;
        if (inputPass === PASSWORD) {
          loginScreen.classList.add("hidden");
          editorScreen.classList.remove("hidden");
          loadPosts();
        } else {
          loginError.classList.remove("hidden");
        }
      });

      // ‚úçÔ∏è Live Preview
      const titleInput = document.getElementById("title");
      const dateInput = document.getElementById("date");
      const contentInput = document.getElementById("content");

      function updatePreview() {
        document.getElementById("preview-title").textContent = titleInput.value || "Post title...";
        document.getElementById("preview-date").textContent = dateInput.value || "Post date...";
        document.getElementById("preview-content").innerHTML =
          contentInput.value || "Start writing to see preview...";
      }
      [titleInput, dateInput, contentInput].forEach((input) =>
        input.addEventListener("input", updatePreview)
      );

      // üóÇÔ∏è Load & Render Posts
      async function loadPosts() {
        try {
          const res = await fetch("assets/data/posts.json");
          const posts = await res.json();
          renderPosts(posts);
        } catch (err) {
          console.error("Error loading posts:", err);
        }
      }

      function renderPosts(posts) {
        const list = document.getElementById("posts-list");
        list.innerHTML = "";
        posts.forEach((post, index) => {
          const div = document.createElement("div");
          div.className = "post-card";
          div.innerHTML = `<h3 class='font-bold text-lg'>${post.title}</h3>
                         <p class='text-gray-600 text-sm mb-2'>${post.date}</p>
                         <button class='bg-blue-500 text-white px-3 py-1 rounded' onclick='editPost(${index})'>Edit</button>`;
          list.appendChild(div);
        });
      }

      // ‚úèÔ∏è Edit Post
      async function editPost(index) {
        const res = await fetch("assets/data/posts.json");
        const posts = await res.json();
        const post = posts[index];
        document.getElementById("edit-index").value = index;
        titleInput.value = post.title;
        dateInput.value = post.date;
        contentInput.value = post.content;
        updatePreview();
      }

      // üíæ Save or Update Post
      document.getElementById("save-btn").addEventListener("click", async () => {
        const title = titleInput.value.trim();
        const date = dateInput.value;
        const content = contentInput.value.trim();
        if (!title || !date || !content) return alert("All fields are required!");

        const res = await fetch("assets/data/posts.json");
        const posts = await res.json();
        const editIndex = document.getElementById("edit-index").value;

        if (editIndex !== "") {
          posts[editIndex] = { title, date, content };
        } else {
          posts.push({ title, date, content });
        }

        // Save back to JSON (in real case, you'd POST to a server)
        localStorage.setItem("posts", JSON.stringify(posts));
        alert("Post saved (locally). Server integration needed to persist.");
        renderPosts(posts);
        clearForm();
      });

      // üßπ Clear
      document.getElementById("clear-btn").addEventListener("click", clearForm);
      function clearForm() {
        titleInput.value = "";
        dateInput.value = "";
        contentInput.value = "";
        document.getElementById("edit-index").value = "";
        updatePreview();
      }
    </script>
  </body>
</html>
